<div class="p-6">
    <div class="flex items-center justify-between mb-6">
        <h2 class="text-xl font-semibold">{{ getTitle() }}</h2>
        <button
            mat-icon-button
            (click)="onCancel()"
            class="text-gray-500 hover:text-gray-700">
            <mat-icon [svgIcon]="'heroicons_outline:x-mark'"></mat-icon>
        </button>
    </div>

    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <mat-form-field class="w-full">
                <mat-label>Họ và tên *</mat-label>
                <input 
                    matInput 
                    formControlName="name" 
                    placeholder="Nhập họ và tên"
                    required>
                <mat-error *ngIf="form.get('name')?.hasError('required')">
                    Họ và tên là bắt buộc
                </mat-error>
                <mat-error *ngIf="form.get('name')?.hasError('minlength')">
                    Họ và tên phải có ít nhất 2 ký tự
                </mat-error>
            </mat-form-field>

            <mat-form-field class="w-full">
                <mat-label>Email *</mat-label>
                <input 
                    matInput 
                    formControlName="email" 
                    placeholder="Nhập email"
                    type="email"
                    required>
                <mat-error *ngIf="form.get('email')?.hasError('required')">
                    Email là bắt buộc
                </mat-error>
                <mat-error *ngIf="form.get('email')?.hasError('email')">
                    Email không hợp lệ
                </mat-error>
            </mat-form-field>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <mat-form-field class="w-full">
                <mat-label>Mật khẩu {{ mode === 'create' ? '*' : '' }}</mat-label>
                <input 
                    matInput 
                    formControlName="password" 
                    placeholder="{{ mode === 'create' ? 'Nhập mật khẩu' : 'Để trống nếu không thay đổi' }}"
                    type="password"
                    [required]="mode === 'create'">
                <mat-error *ngIf="form.get('password')?.hasError('required')">
                    Mật khẩu là bắt buộc
                </mat-error>
                <mat-error *ngIf="form.get('password')?.hasError('minlength')">
                    Mật khẩu phải có ít nhất 6 ký tự
                </mat-error>
            </mat-form-field>

            <mat-form-field class="w-full">
                <mat-label>Loại nhân viên *</mat-label>
                <mat-select formControlName="type" required>
                    <mat-option value="staff">Nhân viên</mat-option>
                    <mat-option value="manager">Quản lý</mat-option>
                    <mat-option value="boss">Sếp</mat-option>
                    <mat-option value="admin">Admin</mat-option>
                </mat-select>
                <mat-error *ngIf="form.get('type')?.hasError('required')">
                    Vui lòng chọn loại nhân viên
                </mat-error>
            </mat-form-field>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <mat-form-field class="w-full">
                <mat-label>Trạng thái</mat-label>
                <mat-select formControlName="status">
                    <mat-option value="online">Online</mat-option>
                    <mat-option value="banned">Bị cấm</mat-option>
                    <mat-option value="disabled">Vô hiệu hóa</mat-option>
                </mat-select>
            </mat-form-field>

            <mat-form-field class="w-full">
                <mat-label>Công ty *</mat-label>
                <mat-select formControlName="companyId" required>
                    <mat-option *ngFor="let company of companies" [value]="company.id">
                        {{company.name}}
                    </mat-option>
                </mat-select>
                <mat-error *ngIf="form.get('companyId')?.hasError('required')">
                    Vui lòng chọn công ty
                </mat-error>
            </mat-form-field>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <mat-form-field class="w-full">
                <mat-label>Phòng ban *</mat-label>
                <mat-select formControlName="departmentId" required [disabled]="!form.get('companyId')?.value">
                    <mat-option *ngFor="let department of filteredDepartments" [value]="department.id">
                        {{department.name}}
                    </mat-option>
                </mat-select>
                <mat-error *ngIf="form.get('departmentId')?.hasError('required')">
                    Vui lòng chọn phòng ban
                </mat-error>
            </mat-form-field>
        </div>

        <div class="flex justify-end gap-3 pt-4">
            <button
                type="button"
                mat-stroked-button
                (click)="onCancel()">
                Hủy
            </button>
            <button
                type="submit"
                mat-flat-button
                [color]="'primary'"
                [disabled]="!form.valid">
                {{ getSubmitButtonText() }}
            </button>
        </div>
    </form>
</div>
