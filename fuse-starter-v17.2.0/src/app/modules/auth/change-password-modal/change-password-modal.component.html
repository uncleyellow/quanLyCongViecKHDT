<div class="flex flex-col flex-auto min-w-0">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row space-y-16 sm:space-y-0 flex-0 sm:items-center sm:justify-between p-10 sm:py-10 sm:px-10 border-b">
        <div class="flex flex-col space-y-8">
            <div>
                <h2 class="text-3xl font-bold tracking-tight">Đổi mật khẩu</h2>
                <p class="text-secondary">Vui lòng đổi mật khẩu của bạn để tiếp tục sử dụng hệ thống</p>
            </div>
        </div>
    </div>

    <!-- Form -->
    <div class="flex-auto p-10 sm:p-10">
        <form [formGroup]="changePasswordForm" (ngSubmit)="changePassword()">
            <!-- Alert -->
            <fuse-alert
                *ngIf="showAlert"
                [appearance]="'outline'"
                [showIcon]="false"
                [type]="alert.type"
                class="mb-16">
                {{ alert.message }}
            </fuse-alert>

            <!-- Current Password -->
            <div class="mb-2">
                <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70" for="currentPassword">
                    Mật khẩu hiện tại
                </label>
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label>Nhập mật khẩu hiện tại</mat-label>
                    <input
                        matInput
                        [formControlName]="'currentPassword'"
                        [type]="'password'"
                        [placeholder]="'Nhập mật khẩu hiện tại'"
                        autocomplete="current-password" />
                    <mat-error *ngIf="changePasswordForm.get('currentPassword').hasError('required')">
                        Mật khẩu hiện tại là bắt buộc
                    </mat-error>
                </mat-form-field>
            </div>

            <!-- New Password -->
            <div class="mb-2">
                <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70" for="newPassword">
                    Mật khẩu mới
                </label>
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label>Nhập mật khẩu mới</mat-label>
                    <input
                        matInput
                        [formControlName]="'newPassword'"
                        [type]="'password'"
                        [placeholder]="'Nhập mật khẩu mới'"
                        autocomplete="new-password" />
                    <mat-error *ngIf="changePasswordForm.get('newPassword').hasError('required')">
                        Mật khẩu mới là bắt buộc
                    </mat-error>
                    <mat-error *ngIf="changePasswordForm.get('newPassword').hasError('minlength')">
                        Mật khẩu phải có ít nhất 6 ký tự
                    </mat-error>
                </mat-form-field>
            </div>

            <!-- Confirm Password -->
            <div class="mb-2">
                <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70" for="confirmPassword">
                    Xác nhận mật khẩu mới
                </label>
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label>Nhập lại mật khẩu mới</mat-label>
                    <input
                        matInput
                        [formControlName]="'confirmPassword'"
                        [type]="'password'"
                        [placeholder]="'Nhập lại mật khẩu mới'"
                        autocomplete="new-password" />
                    <mat-error *ngIf="changePasswordForm.get('confirmPassword').hasError('required')">
                        Xác nhận mật khẩu là bắt buộc
                    </mat-error>
                    <mat-error *ngIf="changePasswordForm.get('confirmPassword').hasError('passwordMismatch')">
                        Mật khẩu xác nhận không khớp
                    </mat-error>
                </mat-form-field>
            </div>

            <!-- Actions -->
            <div class="flex flex-col sm:flex-row gap-16">
                <button
                    type="submit"
                    mat-flat-button
                    [color]="'primary'"
                    [disabled]="changePasswordForm.invalid || isLoading"
                    class="flex-auto sm:flex-none">
                    <mat-icon *ngIf="isLoading" class="animate-spin -ml-8 mr-8">heroicons_outline:arrow-path</mat-icon>
                    <span *ngIf="!isLoading">Đổi mật khẩu</span>
                    <span *ngIf="isLoading">Đang xử lý...</span>
                </button>
                
                <button
                    type="button"
                    mat-stroked-button
                    (click)="onCancel()"
                    [disabled]="isLoading"
                    class="flex-auto sm:flex-none">
                    Hủy
                </button>
            </div>
        </form>
    </div>
</div> 